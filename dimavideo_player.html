<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>پخش‌کننده ویدیوی حرفه‌ای</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome برای آیکون‌ها -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      background: #0a0a0f;
      color: #fff;
      margin: 0;
      padding: 20px;
      font-family: 'Segoe UI', Tahoma, sans-serif;
    }
    .video-wrapper {
      max-width: 900px;
      margin: 0 auto;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
      background: #000;
      position: relative;
    }
    #customVideo {
      width: 100%;
      display: block;
      background: black;
      outline: none;
    }

    /* کنترل‌های سفارشی */
    .custom-controls {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
      padding: 12px 16px;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
    }
    .video-wrapper:hover .custom-controls {
      opacity: 1;
      pointer-events: all;
    }
    .controls-row {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .play-btn, .volume-btn, .fullscreen-btn, .settings-btn {
      background: rgba(50, 50, 50, 0.7);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      color: white;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
    }
    .play-btn:hover, .volume-btn:hover, .fullscreen-btn:hover, .settings-btn:hover {
      background: rgba(80, 80, 80, 0.9);
    }

    /* اسلایدر پیشرفت */
    .progress-container {
      flex: 1;
      height: 6px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 3px;
      cursor: pointer;
      position: relative;
    }
    .progress-bar {
      height: 100%;
      background: #0d6efd;
      width: 0%;
      border-radius: 3px;
      position: relative;
    }
    .progress-bar::after {
      content: '';
      position: absolute;
      right: -6px;
      top: 50%;
      transform: translateY(-50%);
      width: 12px;
      height: 12px;
      background: #0d6efd;
      border-radius: 50%;
      opacity: 0;
      transition: opacity 0.2s;
    }
    .progress-container:hover .progress-bar::after {
      opacity: 1;
    }

    /* منوی تنظیمات */
    .settings-menu {
      position: absolute;
      bottom: 60px;
      right: 16px;
      background: #222;
      border: 1px solid #444;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
      z-index: 10;
      display: none;
      min-width: 140px;
    }
    .settings-menu.show {
      display: block;
    }
    .settings-menu h6 {
      padding: 8px 12px;
      margin: 0;
      font-size: 13px;
      color: #aaa;
      border-bottom: 1px solid #333;
    }
    .settings-item {
      padding: 8px 12px;
      color: #ddd;
      cursor: pointer;
      font-size: 14px;
    }
    .settings-item:hover, .settings-item.active {
      background: #0d6efd;
      color: white;
    }

    /* زمان */
    .time-display {
      font-size: 12px;
      color: #ccc;
      min-width: 60px;
      text-align: right;
    }

    /* پاسخ‌گویی */
    @media (max-width: 768px) {
      .controls-row {
        gap: 8px;
      }
      .play-btn, .volume-btn, .fullscreen-btn, .settings-btn {
        width: 36px;
        height: 36px;
        font-size: 14px;
      }
      .time-display {
        font-size: 11px;
        min-width: 50px;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <div class="video-wrapper" id="videoWrapper">
    <video id="customVideo">
      <source src="video_720p.mp4" type="video/mp4">
    </video>

    <!-- کنترل‌های سفارشی -->
    <div class="custom-controls">
      <div class="progress-container" id="progressContainer">
        <div class="progress-bar" id="progressBar"></div>
      </div>

      <div class="controls-row mt-2">
        <button class="play-btn" id="playBtn">
          <i class="fas fa-play"></i>
        </button>

        <div class="time-display" id="timeDisplay">0:00 / 0:00</div>

        <div class="progress-container" style="flex: 0 0 100px; height: 5px;">
          <div class="progress-bar" id="volumeBar" style="width: 100%;"></div>
        </div>

        <button class="volume-btn" id="volumeBtn">
          <i class="fas fa-volume-up"></i>
        </button>

        <button class="fullscreen-btn" id="fullscreenBtn">
          <i class="fas fa-expand"></i>
        </button>

        <button class="settings-btn" id="settingsBtn">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </div>

    <!-- منوی تنظیمات (کیفیت + سرعت) -->
    <div class="settings-menu" id="settingsMenu">
      <h6>کیفیت</h6>
      <div class="settings-item active" data-quality="720p" data-src="video_720p.mp4">720p</div>
      <div class="settings-item" data-quality="360p" data-src="video_360p.mp4">360p</div>
      <div class="settings-item" data-quality="1080p" data-src="video_1080p.mp4">1080p</div>

      <h6 class="mt-2">سرعت پخش</h6>
      <div class="settings-item" data-speed="0.5">0.5x</div>
      <div class="settings-item" data-speed="0.75">0.75x</div>
      <div class="settings-item active" data-speed="1">1x</div>
      <div class="settings-item" data-speed="1.25">1.25x</div>
      <div class="settings-item" data-speed="1.5">1.5x</div>
      <div class="settings-item" data-speed="2">2x</div>
    </div>
  </div>
</div>

<!-- Bootstrap + JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
  const video = document.getElementById('customVideo');
  const playBtn = document.getElementById('playBtn');
  const progressBar = document.getElementById('progressBar');
  const progressContainer = document.getElementById('progressContainer');
  const timeDisplay = document.getElementById('timeDisplay');
  const volumeBar = document.getElementById('volumeBar');
  const volumeBtn = document.getElementById('volumeBtn');
  const fullscreenBtn = document.getElementById('fullscreenBtn');
  const settingsBtn = document.getElementById('settingsBtn');
  const settingsMenu = document.getElementById('settingsMenu');
  const videoWrapper = document.getElementById('videoWrapper');

  // وضعیت اولیه
  video.volume = 1;

  // پخش/توقف
  playBtn.addEventListener('click', () => {
    if (video.paused) {
      video.play();
      playBtn.innerHTML = '<i class="fas fa-pause"></i>';
    } else {
      video.pause();
      playBtn.innerHTML = '<i class="fas fa-play"></i>';
    }
  });

  video.addEventListener('play', () => {
    playBtn.innerHTML = '<i class="fas fa-pause"></i>';
  });
  video.addEventListener('pause', () => {
    playBtn.innerHTML = '<i class="fas fa-play"></i>';
  });

  // به‌روزرسانی پیشرفت
  video.addEventListener('timeupdate', () => {
    const percent = (video.currentTime / video.duration) * 100;
    progressBar.style.width = percent + '%';
    timeDisplay.textContent = formatTime(video.currentTime) + ' / ' + formatTime(video.duration);
  });

  // کلیک روی نوار پیشرفت
  progressContainer.addEventListener('click', (e) => {
    const rect = progressContainer.getBoundingClientRect();
    const pos = (e.clientX - rect.left) / rect.width;
    video.currentTime = pos * video.duration;
  });

  // تنظیم صدا
  volumeBar.parentElement.addEventListener('click', (e) => {
    const rect = volumeBar.parentElement.getBoundingClientRect();
    let vol = (e.clientX - rect.left) / rect.width;
    vol = Math.min(1, Math.max(0, vol));
    video.volume = vol;
    volumeBar.style.width = vol * 100 + '%';
    updateVolumeIcon(vol);
  });

  function updateVolumeIcon(vol) {
    const icon = volumeBtn.querySelector('i');
    if (vol === 0) {
      icon.className = 'fas fa-volume-mute';
    } else if (vol < 0.5) {
      icon.className = 'fas fa-volume-down';
    } else {
      icon.className = 'fas fa-volume-up';
    }
  }

  // فول‌اسکرین
  fullscreenBtn.addEventListener('click', () => {
    if (!document.fullscreenElement) {
      videoWrapper.requestFullscreen().catch(err => console.log(err));
      fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
    } else {
      document.exitFullscreen();
      fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
    }
  });

  document.addEventListener('fullscreenchange', () => {
    if (!document.fullscreenElement) {
      fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
    }
  });

  // منوی تنظیمات
  settingsBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    settingsMenu.classList.toggle('show');
  });

  // بستن منو با کلیک خارج
  document.addEventListener('click', (e) => {
    if (!settingsMenu.contains(e.target) && e.target !== settingsBtn) {
      settingsMenu.classList.remove('show');
    }
  });

  // تغییر کیفیت
  document.querySelectorAll('[data-quality]').forEach(item => {
    item.addEventListener('click', function() {
      const src = this.getAttribute('data-src');
      const label = this.getAttribute('data-quality');

      // فعال‌سازی آیتم
      document.querySelectorAll('[data-quality]').forEach(el => el.classList.remove('active'));
      this.classList.add('active');

      // تغییر ویدیو
      const currentTime = video.currentTime;
      const paused = video.paused;
      video.src = src;
      video.load();
      video.currentTime = currentTime;
      if (!paused) video.play();

      settingsMenu.classList.remove('show');
    });
  });

  // تغییر سرعت
  document.querySelectorAll('[data-speed]').forEach(item => {
    item.addEventListener('click', function() {
      const speed = parseFloat(this.getAttribute('data-speed'));
      video.playbackRate = speed;

      document.querySelectorAll('[data-speed]').forEach(el => el.classList.remove('active'));
      this.classList.add('active');
      settingsMenu.classList.remove('show');
    });
  });

  // فرمت زمان (ثانیه → mm:ss)
  function formatTime(seconds) {
    if (isNaN(seconds)) return '0:00';
    const min = Math.floor(seconds / 60);
    const sec = Math.floor(seconds % 60);
    return min + ':' + (sec < 10 ? '0' : '') + sec;
  }
</script>

</body>
</html>